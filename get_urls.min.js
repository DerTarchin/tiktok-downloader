javascript: (function () {
  var height = document.body.scrollHeight,
    linksMap = new Map([]);
  function loadWebpage() {
    window.scrollTo({
      top: document.body.scrollHeight - window.outerHeight,
      behavior: "smooth",
    }),
      setTimeout(() => {
        window.scrollTo({
          top: document.body.scrollHeight,
          behavior: "smooth",
        }),
          setTimeout(() => {
            height !== document.body.scrollHeight
              ? (addArray(),
                setTimeout(() => {
                  (height = document.body.scrollHeight), loadWebpage();
                }, Math.floor(500 * Math.random() + 10)))
              : setTimeout(() => {
                  (document.querySelector(
                    "#main-content-others_homepage .css-qmnyxf-SvgContainer"
                  ) || height != document.body.scrollHeight
                    ? loadWebpage
                    : ytDlpScript)();
                }, 1e3);
          }, 150);
      }, Math.floor(600 * Math.random() + 600));
  }
  function addArray() {
    var o = Array.from(
      document.querySelectorAll("a[href*='/video/'], a[href*='/photo/']")
    );
    for (const t of o) {
      var e = t.href;
      t &&
        ("" === (e ?? "")
          ? console.log("SCRIPT ERROR: Failed to get link!")
          : (console.log(e), linksMap.set(e, {})));
    }
    console.log("Links found: " + linksMap.size);
    for (const r of Array.from(o).slice(0, o.length - 20)) r.remove();
  }
  function ytDlpScript() {
    addArray();
    let o = "";
    for (var [e] of Array.from(linksMap)) o += `${e}\n`;
    downloadScript(o);
  }
  function downloadScript(o) {
    var o = new Blob([o], { type: "text/plain" }),
      e = document.createElement("a"),
      t = `${
        document.querySelector("h1")?.textContent.trim() ?? "TikTokLinks"
      }.txt`;
    (e.href = URL.createObjectURL(new File([o], t, { type: "text/plain" }))),
      (e.download = t),
      e.click(),
      URL.revokeObjectURL(e.href);
  }
  function startDownload(o) {
    (linksMap = new Map([])), loadWebpage();
  }
  startDownload();
})();
